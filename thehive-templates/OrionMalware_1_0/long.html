<style>
.label-low{
    background-color:#739e73 !important;
    color:white !important;
    text-align: left !important;
    border-radius: .25em;
}
.label-medium{
    background-color: #c79121 !important;
    color:white !important;
    text-align: left !important;
    border-radius: .25em;
}
.label-high{
    background-color:#a90329 !important;
    color:white !important;
    text-align: left !important;
    border-radius: .25em;
}
.label-severe{
    background-color: #5203a9 !important;
    color:white !important;
    text-align: left !important;
    border-radius: .25em;
}
.label-safe{
    background-color: #57889c !important;
    color:white !important;
    text-align: left !important;
    border-radius: .25em;
}
label {
    padding: 2px 7px;
    max-width: 500px;
    font-size: 90%;
}
</style>

<div class="panel panel-info" ng-if="success && content.results.report.filereport">
	<div class="panel-heading">
		Overview
	</div>
	<div class="panel-body">
        <div class="row">
            <div class="col-md-2">
                <strong class="text-info">Risk</strong>
            </div>
            <div class="col-md-10">
                <label class="label-{{content.results.report.filereport.risk.level | lowercase}}">{{content.results.report.filereport.risk.level}}</label>
            </div>
        </div>
        <div class="row">
            <div class="col-md-2">
                <strong class="text-info">Full Report URL</strong>
            </div>
            <a class="col-md-10" href="{{content.results.report_url}}">{{content.results.report_url}}</a>
        </div>
        <div class="row">
            <div class="col-md-2">
                <strong class="text-info">Filename</strong></div>
                <div class="col-md-10">{{content.results.report.filereport.identification.filename}}</div>
            <div class="col-md-2">
                <strong class="text-info">MD5</strong></div>
                <div class="col-md-10">{{content.results.report.filereport.identification.md5}}</div>
            <div class="col-md-2">
                <strong class="text-info">SHA1</strong></div>
                <div class="col-md-10">{{content.results.report.filereport.identification.sha1}}</div>
             <div class="col-md-2">
                <strong class="text-info">SHA256</strong></div>
                 <div class="col-md-10">{{content.results.report.filereport.identification.sha256}}</div>
            <div class="col-md-2">
                <strong class="text-info">Size</strong></div>
                <div class="col-md-10">{{content.results.report.filereport.identification.size}}</div>
            <div class="col-md-2">
               <strong class="text-info">Type</strong></div>
               <div class="col-md-10">{{content.results.report.filereport.identification.type}}</div>
             </div>
    </div>
</div>

<div class="panel panel-info" ng-if="success && content.results.report.filereport.rules.length > 0">
	<div class="panel-heading">
		Triggered Rules
	</div>
    <div class="panel-body">
        <table class="table">
            <thead>
                <th width="50px">Rule format</th>
                <th width="125px">Rule name</th>
                <th width="125px">Rule type</th>
            </thead>
            <tbody ng-repeat="rul in content.results.report.filereport.rules">
                <tr>
                    <td>{{rul.format}}</td>
                    <td>{{rul.name}}</td>
                    <td>{{rul.type}}</td>
                </tr>
            </tbody>
        </table>
	</div>
</div>

<div class="panel panel-info" ng-if="success && content.results.report.filereport.threat_analysis.length > 0">
	<div class="panel-heading">
		Threat Engines Analysis
	</div>
	<div class="panel-body">
        <table class="table">
            <thead>
                <th width="50px">Engine Name</th>
                <th width="125px">Threat Name</th>
            </thead>
            <tbody ng-repeat="tre in content.results.report.filereport.threat_analysis">
                <tr>
                    <td>{{tre.engine_name}}</td>
                    <td>
                        <label class="label-high" ng-if="tre.threat_name != ''">{{tre.threat_name}}</label>
                        <label ng-if="tre.threat_name == ''">No threat detected</label>
                    </td>
                </tr>
            </tbody>
        </table>
	</div>
</div>

<div class="panel panel-info"
     ng-if="success && (content.results.report.filereport.risk.scanner.descriptions.files.length > 0 ||
                        content.results.report.filereport.risk.scanner.descriptions.network.length > 0 ||
                        content.results.report.filereport.risk.scanner.descriptions.persistence.length > 0 ||
                        content.results.report.filereport.risk.scanner.descriptions.processes.length > 0 ||
                        content.results.report.filereport.risk.scanner.descriptions.system.length > 0)">
	<div class="panel-heading">
		Static analysis (Scanner)
	</div>
	<div class="panel-body">
        <table class="table" ng-if="content.results.report.filereport.risk.scanner.descriptions.files.length > 0">
            <thead>
                <th width="400px">
                    Files Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.scanner.descriptions.files">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.scanner.descriptions.network.length > 0">
            <thead>
                <th width="400px">Network Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.scanner.descriptions.network">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.scanner.descriptions.persistence.length > 0">
            <thead>
                <th width="400px">Persistence Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.scanner.descriptions.persistence">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.scanner.descriptions.processes.length > 0">
            <thead>
                <th width="400px">Process Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.scanner.descriptions.processes">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.scanner.descriptions.system.length > 0">
            <thead>
                <th width="400px">System Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.scanner.descriptions.system">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
	</div>
</div>
<div class="panel panel-info"
     ng-if="success && (content.results.report.filereport.risk.dynamic.descriptions.files.length > 0 ||
                        content.results.report.filereport.risk.dynamic.descriptions.network.length > 0 ||
                        content.results.report.filereport.risk.dynamic.descriptions.persistence.length > 0 ||
                        content.results.report.filereport.risk.dynamic.descriptions.processes.length > 0 ||
                        content.results.report.filereport.risk.dynamic.descriptions.system.length > 0)"
    >
	<div class="panel-heading">
		Dynamic analysis (Sandbox)
	</div>
	<div class="panel-body">
        <table class="table" ng-if="content.results.report.filereport.risk.dynamic.descriptions.files.length > 0">
            <thead>
                <th width="400px">
                    Files Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.dynamic.descriptions.files">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.dynamic.descriptions.network.length > 0">
            <thead>
                <th width="400px">Network Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.dynamic.descriptions.network">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.dynamic.descriptions.persistence.length > 0">
            <thead>
                <th width="400px">Persistence Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.dynamic.descriptions.persistence">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.dynamic.descriptions.processes.length > 0">
            <thead>
                <th width="400px">Process Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.dynamic.descriptions.processes">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
        <table class="table" ng-if="content.results.report.filereport.risk.dynamic.descriptions.system.length > 0">
            <thead>
                <th width="400px">System Malicious Activities
                </th>
            </thead>
            <tbody ng-repeat="mal_act in content.results.report.filereport.risk.dynamic.descriptions.system">
                <tr>
                    <td>{{mal_act}}</td>
                </tr>
            </tbody>
        </table>
	</div>
</div>

<!-- General error  -->
<div class="panel panel-danger" ng-if="!success">
    <div class="panel-heading">
        <strong>{{(artifact.data || artifact.attachment.name) | fang}}</strong>
    </div>
    <div class="panel-body">
    	<dl class="dl-horizontal" ng-if="content.errorMessage">
            <dt><i class="fa fa-warning"></i> Orion Malware : </dt>
            <dd class="wrap">{{content.errorMessage}}</dd>
        </dl>
    </div>
</div>